<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Game Market</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'tg-bg': 'var(--tg-theme-bg-color, #17212b)',
                        'tg-text': 'var(--tg-theme-text-color, #ffffff)',
                        'tg-hint': 'var(--tg-theme-hint-color, #708499)',
                        'tg-link': 'var(--tg-theme-link-color, #62bcf9)',
                        'tg-button': 'var(--tg-theme-button-color, #5288c1)',
                        'tg-secondary-bg': 'var(--tg-theme-secondary-bg-color, #222e3a)',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fade-in { 
            from { opacity: 0; transform: translateY(1rem); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .nav-item.active {
            color: var(--tg-theme-link-color, #62bcf9);
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Chat messages styles */
        .message {
            max-width: 80%;
            margin-bottom: 12px;
            padding: 8px 12px;
            border-radius: 18px;
            word-wrap: break-word;
        }
        .message.sent {
            background-color: var(--tg-theme-button-color, #5288c1);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        .message.received {
            background-color: var(--tg-theme-secondary-bg-color, #222e3a);
            color: var(--tg-theme-text-color, #ffffff);
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }
        .message img {
            max-width: 200px;
            border-radius: 8px;
            margin-top: 4px;
        }
    </style>
</head>
<body class="bg-tg-bg text-tg-text font-sans antialiased overflow-hidden">

    <div id="app" class="h-screen w-screen flex flex-col">
        <main class="flex-grow overflow-y-auto">
            <div id="home-page" class="page">
                <div class="swiper h-48">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide"><img src="https://via.placeholder.com/600x360/2ea6ff/ffffff?text=Top+O'yinlar" class="w-full h-full object-cover"></div>
                        <div class="swiper-slide"><img src="https://via.placeholder.com/600x360/333333/ffffff?text=Aksiya" class="w-full h-full object-cover"></div>
                    </div>
                </div>
                <div class="px-4 py-3">
                    <div class="flex gap-2 overflow-x-auto no-scrollbar pb-2" id="category-filters">
                        <button data-category="all" class="category-btn active bg-tg-button text-white px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap">All</button>
                        <button data-category="PUBG" class="category-btn bg-tg-secondary-bg text-tg-text px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap">PUBG</button>
                        <button data-category="Free Fire" class="category-btn bg-tg-secondary-bg text-tg-text px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap">Free Fire</button>
                        <button data-category="Mobile Legends" class="category-btn bg-tg-secondary-bg text-tg-text px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap">Mobile Legends</button>
                        <button data-category="CSGO" class="category-btn bg-tg-secondary-bg text-tg-text px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap">CSGO</button>
                    </div>
                </div>
                <div class="flex justify-between items-center px-4 pt-1 pb-3">
                    <h2 class="text-2xl font-bold tracking-tight">All Items</h2>
                    <div id="loading-indicator" class="loading hidden"></div>
                </div>
                <div id="card-container" class="px-4 pb-4 grid grid-cols-2 gap-4"></div>
            </div>

            <div id="buy-stars-page" class="page hidden p-4 text-center">
                <h2 class="text-xl font-bold mt-10">Buy Stars</h2>
                <p class="text-tg-hint mt-2">Bu bo'lim tez kunda ishga tushadi.</p>
            </div>
            
            <div id="history-page" class="page hidden p-4 text-center">
                <h2 class="text-xl font-bold mt-10">History</h2>
                <p class="text-tg-hint mt-4 text-center">Hozircha amallar mavjud emas.</p>
            </div>

            <div id="profile-page" class="page hidden">
                <div id="profile-main">
                    <div class="flex flex-col items-center p-6">
                        <img id="profile-photo" class="w-24 h-24 rounded-full border-2 border-tg-link">
                        <h2 id="profile-name" class="text-2xl font-bold mt-4"></h2>
                    </div>
                    <div class="px-4 flex flex-col gap-3">
                        <div onclick="navigateTo({type: 'page', id: 'my-purchases-page'})" class="bg-tg-secondary-bg p-4 rounded-xl flex justify-between items-center cursor-pointer transition-transform active:scale-[0.98]">
                            <div class="flex items-center gap-4">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-tg-hint">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.328 1.093-.826l1.821-6.831c.13-.483-.145-.996-.644-1.17a48.11 48.11 0 00-1.821-.545A48.11 48.11 0 007.5 4.5M4.5 19.5h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z" />
                                </svg>
                                <span class="font-medium">Mening Xaridlarim</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-tg-hint">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                            </svg>
                        </div>
                        <div onclick="navigateTo({type: 'subpage', id: 'help-subpage'})" class="bg-tg-secondary-bg p-4 rounded-xl flex justify-between items-center cursor-pointer transition-transform active:scale-[0.98]">
                            <div class="flex items-center gap-4">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-tg-hint">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                                </svg>
                                <span class="font-medium">Yordam</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-tg-hint">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                            </svg>
                        </div>
                        <div onclick="navigateTo({type: 'chat', id: 'chat-page'})" class="bg-tg-secondary-bg p-4 rounded-xl flex justify-between items-center cursor-pointer transition-transform active:scale-[0.98]">
                            <div class="flex items-center gap-4">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-tg-hint">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.325 3.218.086 6.533-.533 9.491-2.311A2.25 2.25 0 0021 18.75V7.5a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 7.5v1.51z" />
                                </svg>
                                <span class="font-medium">Support</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-tg-hint">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                            </svg>
                        </div>
                    </div>
                </div>
                <div id="help-subpage" class="hidden p-4">
                    <h2 class="text-xl font-bold text-center mb-4">Ilova haqida</h2>
                    <p class="text-tg-hint text-center">Bu ilova o'yin akkauntlarini sotib olish va sotish uchun mo'ljallangan platforma.</p>
                </div>
            </div>

            <div id="my-purchases-page" class="page hidden p-4">
                <h2 class="text-xl font-bold">Mening Xaridlarim</h2>
                <p class="text-tg-hint mt-4 text-center">Bu yerda siz sotib olgan akkauntlarning login va parollari ko'rinadi.</p>
            </div>
            
            <div id="chat-page" class="page hidden flex flex-col h-full">
                <header class="flex-shrink-0 p-4 bg-tg-secondary-bg flex items-center gap-4 border-b border-gray-700/50">
                    <img src="https://via.placeholder.com/40" class="w-10 h-10 rounded-full">
                    <div>
                        <h3 class="font-bold">Support</h3>
                        <p class="text-sm text-tg-hint">online</p>
                    </div>
                </header>
                <div id="chat-messages" class="flex-grow p-4 overflow-y-auto flex flex-col">
                    <div class="message received">
                        <p>Salom! Sizga qanday yordam bera olaman?</p>
                        <span class="text-xs opacity-70">10:30</span>
                    </div>
                </div>
                <footer class="flex-shrink-0 p-2 bg-tg-secondary-bg border-t border-gray-700/50">
                    <div class="flex items-center gap-2">
                        <input type="file" id="image-input" accept="image/*" class="hidden">
                        <button onclick="selectImage()" class="w-10 h-10 bg-tg-bg rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-tg-hint">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
                            </svg>
                        </button>
                        <input type="text" id="message-input" placeholder="Xabar yozing..." class="flex-1 bg-tg-bg rounded-full py-2 px-4 focus:outline-none">
                        <button onclick="sendMessage()" class="w-10 h-10 bg-tg-button rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-white">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                            </svg>
                        </button>
                    </div>
                </footer>
            </div>
        </main>
        
        <footer id="bottom-nav" class="flex-shrink-0 h-16 bg-tg-secondary-bg/80 backdrop-blur-xl border-t border-gray-700/50 flex justify-around items-center"></footer>
    </div>
    
    <div id="item-modal" class="fixed inset-0 bg-tg-bg z-50 hidden flex-col transition-opacity duration-300 opacity-0"></div>

    <script src="app.js"></script>
</body>
</html>
